# éƒ¨ç½²å’Œæœ¬åœ°é”™è¯¯ä¿®å¤æ€»ç»“

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### 1. éƒ¨ç½²é”™è¯¯ï¼šnpm ç½‘ç»œè¿æ¥å¤±è´¥

**é—®é¢˜æè¿°ï¼š**
- éƒ¨ç½²æ—¶ npm è¯•å›¾ä»ä¼ä¸šå†…éƒ¨é•œåƒ `npm.corp.kuaishou.com` ä¸‹è½½åŒ…
- é”™è¯¯ï¼š`npm error network request to https://npm.corp.kuaishou.com/simple-swizzle/-/simple-swizzle-0.2.4.tgz failed, reason: getaddrinfo ENOTFOUND npm.corp.kuaishou.com`

**æ ¹æœ¬åŸå› ï¼š**
- `package-lock.json` æ–‡ä»¶ä¸­é”å®šäº†ä¼ä¸šå†…éƒ¨é•œåƒ URL
- è¿™äº›é”å®šçš„ URL åœ¨ Cloudflare Pages éƒ¨ç½²ç¯å¢ƒä¸­æ— æ³•è®¿é—®

**è§£å†³æ–¹æ¡ˆï¼š**
1. âœ… å¤‡ä»½æ—§çš„ `package-lock.json`
2. âœ… åˆ é™¤æ—§çš„ `package-lock.json`
3. âœ… é‡æ–°è¿è¡Œ `npm install` ç”Ÿæˆæ–°çš„ `package-lock.json`
4. âœ… æ–°æ–‡ä»¶ä½¿ç”¨å®˜æ–¹ npm registry (`registry.npmjs.org`)

**éªŒè¯ç»“æœï¼š**
- âœ… æ–°çš„ `package-lock.json` ä¸­ **0 ä¸ª**ä¼ä¸šå†…éƒ¨é•œåƒå¼•ç”¨
- âœ… æ‰€æœ‰åŒ…ç°åœ¨ä½¿ç”¨å®˜æ–¹ registry (`registry.npmjs.org`)
- âœ… `simple-swizzle` å’Œå…¶ä»–ä¾èµ–åŒ…éƒ½å·²ä¿®å¤

### 2. æœ¬åœ° 404 é”™è¯¯ï¼šé™æ€èµ„æºæ— æ³•åŠ è½½

**é—®é¢˜æè¿°ï¼š**
- æ§åˆ¶å°æ˜¾ç¤ºå¤šä¸ª 404 é”™è¯¯ï¼š
  - `layout.css` 404
  - `main-app.js` 404
  - `app-pages-internals.js` 404
  - `app/page.js` 404
  - `app/not-found.js` 404

**æ ¹æœ¬åŸå› ï¼š**
- Next.js å¼€å‘æœåŠ¡å™¨ç¼“å­˜æŸå
- `.next` ç›®å½•ä¸­çš„æ„å»ºæ–‡ä»¶ä¸å®Œæ•´æˆ–æŸå

**è§£å†³æ–¹æ¡ˆï¼š**
1. âœ… åœæ­¢æ‰€æœ‰ Next.js å¼€å‘æœåŠ¡å™¨è¿›ç¨‹
2. âœ… åˆ é™¤ `.next` ç¼“å­˜ç›®å½•
3. âœ… é‡æ–°å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆç«¯å£ 3002ï¼‰

**éªŒè¯ç»“æœï¼š**
- âœ… æœåŠ¡å™¨åœ¨ 3002 ç«¯å£æˆåŠŸå¯åŠ¨
- âœ… é¦–é¡µè¿”å› 200 çŠ¶æ€ç 
- âœ… ç¼“å­˜å·²æ¸…ç†ï¼Œæ–°çš„æ„å»ºå°†ç”Ÿæˆ

## ğŸ“‹ é…ç½®æ–‡ä»¶çŠ¶æ€

### `.npmrc`
```ini
# Use official npm registry for Cloudflare Pages deployment
registry=https://registry.npmjs.org/

# Disable package-lock for consistency
package-lock=true

# Set timeout for slower networks
fetch-timeout=60000
```

âœ… é…ç½®æ­£ç¡®ï¼Œä½¿ç”¨å®˜æ–¹ npm registry

### `package-lock.json`
- âœ… å·²é‡æ–°ç”Ÿæˆ
- âœ… æ‰€æœ‰åŒ…ä½¿ç”¨ `registry.npmjs.org`
- âœ… æ— ä¼ä¸šå†…éƒ¨é•œåƒå¼•ç”¨

## ğŸš€ ä¸‹ä¸€æ­¥

1. **æµ‹è¯•éƒ¨ç½²ï¼š**
   - æäº¤æ›´æ”¹å¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“
   - éªŒè¯ Cloudflare Pages éƒ¨ç½²æˆåŠŸ
   - ç¡®ä¿ä¸å†å‡ºç°ç½‘ç»œè¿æ¥é”™è¯¯

2. **æœ¬åœ°å¼€å‘ï¼š**
   - å¼€å‘æœåŠ¡å™¨è¿è¡Œåœ¨ `http://localhost:3002`
   - å¦‚æœè¿˜é‡åˆ° 404 é”™è¯¯ï¼Œå†æ¬¡æ¸…ç† `.next` ç¼“å­˜

3. **ç›‘æ§ï¼š**
   - æ£€æŸ¥éƒ¨ç½²æ—¥å¿—ï¼Œç¡®ä¿æ‰€æœ‰ä¾èµ–æ­£ç¡®å®‰è£…
   - éªŒè¯ç”Ÿäº§ç¯å¢ƒæ˜¯å¦æ­£å¸¸å·¥ä½œ

## âš ï¸ æ³¨æ„äº‹é¡¹

- **ä¸è¦æ¢å¤å¤‡ä»½çš„ `package-lock.json`** - å®ƒåŒ…å«ä¼ä¸šå†…éƒ¨é•œåƒå¼•ç”¨
- å¦‚æœæœªæ¥éœ€è¦æ›´æ–°ä¾èµ–ï¼Œç¡®ä¿ä½¿ç”¨å®˜æ–¹ registry
- æœ¬åœ°å¼€å‘æ—¶ï¼Œå¦‚æœé‡åˆ°ç¼“å­˜é—®é¢˜ï¼Œå¯ä»¥è¿è¡Œï¼š
  ```bash
  rm -rf .next && npm run dev
  ```

---

**ä¿®å¤å®Œæˆæ—¶é—´ï¼š** 2025-12-05
**çŠ¶æ€ï¼š** âœ… æ‰€æœ‰é—®é¢˜å·²è§£å†³

